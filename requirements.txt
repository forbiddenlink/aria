# AI Artist - Python Dependencies
# Updated: 2026-01-09 with 2026 Best Practices
# Based on research: SDXL, LoRA training, MLOps, Python 3.11+

# ===================================
# Core AI/ML Libraries
# ===================================

# PyTorch - Install separately based on your system:
# CUDA 11.8: pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
# CUDA 12.1: pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
# Apple Silicon (MPS): pip install torch torchvision torchaudio
# CPU: pip install torch torchvision torchaudio
torch>=2.5.0,<3.0.0  # CVE fixes, compatible with diffusers
torchvision>=0.20.0,<1.0.0
torchaudio>=2.5.0,<3.0.0

# Stable Diffusion and Image Generation
diffusers>=0.32.0,<0.37.0  # Stable version range
transformers>=4.53.0,<5.0.0  # CVE fixes, compatible version range
accelerate>=0.34.0,<2.0.0  # Required for LoRA training (latest is 1.x)
safetensors>=0.5.0,<1.0.0
# xformers>=0.0.24  # Memory-efficient attention (optional, GPU only) - DISABLED: Doesn't build on Apple Silicon

# LoRA Training and PEFT
peft>=0.15.0,<1.0.0  # Latest stable version
# bitsandbytes>=0.42.0  # For AdamW8bit optimizer - DISABLED: Not needed on Apple Silicon

# CLIP for Curation
ftfy>=6.3.1  # Latest stable version
regex>=2025.11.3  # Latest stable version
# CLIP installed separately: pip install git+https://github.com/openai/CLIP.git

# ===================================
# Image Processing
# ===================================

Pillow>=12.1.0  # CVE-2024-28219 fix + latest features
opencv-python>=4.12.0
numpy>=1.24.0,<2.0.0  # Keep <2.0 for compatibility
imageio>=2.37.0
imagehash>=4.3.0  # Perceptual hashing for deduplication
clip @ git+https://github.com/openai/CLIP.git  # For aesthetic evaluation

# ===================================
# API Clients (Modern HTTP)
# ===================================

# Modern async HTTP client (replaces requests)
httpx>=0.28.0,<1.0.0  # Latest stable version

# ===================================
# Web Framework (for Gallery)
# ===================================

# FastAPI for web gallery interface
fastapi>=0.128.0  # Latest stable version
uvicorn[standard]>=0.40.0  # ASGI server - latest stable
python-multipart>=0.0.21  # CVE-2024-53981 fix + latest features
jinja2>=3.1.6  # CVE-2024-34064, CVE-2024-56201, CVE-2024-56326, CVE-2025-27516 fixes
aiohttp>=3.13.3  # CVE-2024-23334, CVE-2024-23829, CVE-2024-27306, CVE-2024-30251, CVE-2024-52304, CVE-2025-53643, CVE-2025-69223, CVE-2025-69224, CVE-2025-69225, CVE-2025-69226, CVE-2025-69227, CVE-2025-69228, CVE-2025-69229, CVE-2025-69230 fixes

# Security and rate limiting
slowapi>=0.1.9  # Rate limiting for FastAPI
python-jose[cryptography]>=3.4.0  # CVE-2024-33663 (CRITICAL), CVE-2024-33664 fixes
passlib[bcrypt]>=1.7.4  # Password hashing (future authentication)
itsdangerous>=2.1.2  # Secure session management

# API wrappers
# unsplash-py==1.1.0  # Deprecated, use httpx directly

# ===================================
# Automation & Scheduling
# ===================================

APScheduler>=3.11.0  # Latest stable version
python-crontab>=3.3.0  # Latest stable version

# ===================================
# Data & Storage
# ===================================

# Configuration management
PyYAML>=6.0.3  # Latest stable version
python-dotenv>=1.2.1  # Latest stable version
pydantic>=2.12.5  # Runtime validation - latest stable
pydantic-settings>=2.12.0  # Latest stable version

# Database
SQLAlchemy>=2.0.45  # ORM - latest stable
alembic>=1.18.0  # Migrations - latest stable
# SQLite is built into Python

# ===================================
# Utilities
# ===================================

# Progress bars
tqdm>=4.66.3  # CVE-2024-34062 fix

# Date/Time
python-dateutil>=2.8.2

# Structured Logging (2026 best practice)
structlog>=24.1.0
colorlog>=6.8.0

# Error Handling & Resilience
tenacity>=8.2.3  # Retry logic with exponential backoff

# ===================================
# Development & Testing
# ===================================

# Testing Framework
pytest>=9.0.2  # Latest stable version
pytest-cov>=6.0.0  # Latest stable version
pytest-mock>=3.14.0  # Latest stable version
pytest-asyncio>=0.25.0  # Latest stable version

# Code Quality
black>=25.12.0  # CVE-2024-21503 fix + latest features
ruff>=0.14.11  # Fast linting (replaces flake8, isort, pydocstyle) - latest stable
mypy>=1.19.1  # Type checking - latest stable
pre-commit>=4.0.1  # Git hooks - latest stable

# Security
safety>=3.5.0  # Check for vulnerable dependencies - latest stable
pip-audit>=2.10.0  # Dependency vulnerability scanner - latest stable
bandit>=1.8.0  # Security linting - latest stable

# ===================================
# MLOps & Experiment Tracking (Optional)
# ===================================

# Uncomment based on your choice:
# wandb>=0.16.0  # Weights & Biases (recommended for image logging)
# mlflow>=2.9.2  # MLflow (recommended for model registry)
# dvc>=3.0.0  # Data Version Control

# ===================================
# Optional: Web Interface
# ===================================

# Uncomment if building web UI:
# gradio>=4.15.0  # Simple UI
# fastapi>=0.109.0  # API server
# uvicorn>=0.27.0  # ASGI server
# python-multipart>=0.0.6  # For file uploads

# ===================================
# Optional: Advanced Features
# ===================================

# Image quality assessment
# pyiqa>=0.1.10  # Image Quality Assessment

# Observability & Monitoring
# opentelemetry-api>=1.21.0  # OpenTelemetry for tracing
# opentelemetry-sdk>=1.21.0
# prometheus-client>=0.19.0  # Metrics collection

# Metadata handling
# piexif>=1.1.3  # EXIF metadata

# ===================================
# Installation Notes
# ===================================

# Installation order (recommended):
# 1. Create virtual environment: python -m venv venv
# 2. Activate: source venv/bin/activate (Linux/Mac) or venv\Scripts\activate (Windows)
# 3. Upgrade pip: pip install --upgrade pip
# 4. Install PyTorch first (see commands above for your system)
# 5. Install requirements: pip install -r requirements.txt
# 6. Install optional dependencies as needed

# Modern alternative using uv (10-100x faster):
# pip install uv
# uv pip install -r requirements.txt

# GPU Requirements:
# - Minimum: 6GB VRAM (SD 1.5)
# - Recommended: 12GB+ VRAM (SDXL)
# - Optimal: 16GB+ VRAM (SDXL with xformers)
# - CPU fallback available but very slow

# Estimated install size: ~8-12GB
# (includes models, dependencies, and cache)

# Python Version Requirements:
# - Minimum: Python 3.11
# - Recommended: Python 3.12
# - Maximum tested: Python 3.12

# Platform Support:
# - ✅ Linux (Ubuntu 20.04+, Debian 11+)
# - ✅ macOS (Intel & Apple Silicon M1/M2/M3)
# - ✅ Windows 10/11 with WSL2 or native

# Known Issues:
# - xformers may require specific PyTorch version
# - bitsandbytes requires CUDA on Linux, not supported on Windows natively
# - Apple Silicon (MPS) works better with fp32 than fp16

# Troubleshooting:
# - CUDA out of memory: Reduce batch size, enable attention slicing
# - Import errors: Ensure PyTorch installed before other packages
# - Version conflicts: Use virtual environment, avoid global installs
